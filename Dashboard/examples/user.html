<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="assets/img/diaverse.png">
    <link rel="icon" type="image/png" href="assets/img/diaverseMini.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Diaverse - User Profile</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <!-- CSS Files -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/light-bootstrap-dashboard.css?v=2.0.0 " rel="stylesheet" />
</head>

<body>
    <div class="wrapper">
        <div class="sidebar" data-color="blue" data-image="assets/img/sidebar-5.jpg">

            <div class="sidebar-wrapper">
                <div class="logo">
                    <a href="dashboard.html" class="simple-text">
                        Diaverse
                    </a>
                </div>
                <ul class="nav">
                    <li>
                        <a class="nav-link" href="dashboard.html">
                            <i class="nc-icon nc-planet"></i>
                            <p>Home</p>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="./user.html">
                            <i class="nc-icon nc-circle-09"></i>
                            <p>User Profile</p>
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="codeEditor.html">
                            <i class="nc-icon nc-notes"></i>
                            <p>Script Editor</p>
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="./scriptDB.html">
                            <i class="nc-icon nc-paper-2"></i>
                            <p>Script Manager</p>
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="./hardwarePortal.html">
                            <i class="nc-icon nc-atom"></i>
                            <p>Hardware Portal</p>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="main-panel">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg " color-on-scroll="500">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#pablo"> User Profile </a>
                    <button href="" class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-bar burger-lines"></span>
                        <span class="navbar-toggler-bar burger-lines"></span>
                        <span class="navbar-toggler-bar burger-lines"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-end" id="navigation">
                        <ul class="nav navbar-nav mr-auto">
                        </ul>
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="./user.html">
                                    <span class="no-icon">Account</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#pablo">
                                    <span class="no-icon">Log out</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <!-- End Navbar -->
            <script>getCookie("username");</script>

            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h4 class="card-title">Edit Profile</h4>
                                </div>
                                <div class="card-body">
                                    <form>
                                        <div class="row">
                                            <div class="col-md-4 px-3">
                                                <div class="form-group">
                                                    <label>Username</label>
                                                    <input type="text" class="form-control" disabled="" placeholder="Username" id="usrName" name="usrName">
                                                </div>
                                            </div>
                                            <div class="col-md-5 pl-1">
                                                <div class="form-group">
                                                    <label for="exampleInputEmail1">Email address</label>
                                                    <input type="email" class="form-control" placeholder="Email" id="usrEmail" name="usrEmail">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6 pr-1">
                                                <div class="form-group">
                                                    <label>First Name</label>
                                                    <input type="text" class="form-control" placeholder="First Name" id="usrFirst" name="usrFirst">
                                                </div>
                                            </div>
                                            <div class="col-md-6 pl-1">
                                                <div class="form-group">
                                                    <label>Last Name</label>
                                                    <input type="text" class="form-control" placeholder="Last Name" id="usrLast" name="usrLast">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                                <div class="col-md-6 pr-1">
                                                    <div class="form-group">
                                                        <label>Password</label>
                                                        <input type="password" class="form-control" placeholder="Password" id="usrPass" name="usrPass">
                                                    </div>
                                                </div>
                                        </div>


                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label>Hardware Key</label>
                                                    <input type="text" class="form-control" disabled="" placeholder="Hardware not yet registered!" id="usrToken" name="usrToken">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label>About Me</label>
                                                    <textarea rows="4" cols="80" class="form-control" placeholder="Tell us about yourself!" id="usrBio" name="usrBio"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-info btn-fill pull-left">Delete Account</button>
                                        <button type="submit" class="btn btn-info btn-fill pull-right" onclick = "updateInfo()">Update Profile</button>
                                        <div class="clearfix"></div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card card-user">
                                <div class="card-image">
                                    <img src="https://ununsplash.imgix.net/photo-1431578500526-4d9613015464?fit=crop&fm=jpg&h=300&q=75&w=400" alt="...">
                                </div>
                                <div class="card-body">
                                    <div class="author">
                                        <a href="#">
                                            <img class="avatar border-gray" src="assets/img/faces/face-0.jpg" alt="...">
                                            <h5 class="title"> 
                                            <label type="text" id="borderName" name="borderName">Name</label>
                                            </h5>
                                        </a>
                                        <p class="description">
                                            <label type="text" id="borderUsername" name="borderUsername">Username</label>
                                        </p>
                                    </div>
                                    <p class="description text-center">
                                            <label type="text" id="borderBio" name="borderBio">Weclome to my profile!</label>
                                    </p>
                                </div>
                                <hr>

                                <!-- Social Media Icon Stuff -->
                                <!-- <div class="button-container mr-auto ml-auto">
                                    <button href="#" class="btn btn-simple btn-link btn-icon">
                                        <i class="fa fa-facebook-square"></i>
                                    </button>
                                    <button href="#" class="btn btn-simple btn-link btn-icon">
                                        <i class="fa fa-twitter"></i>
                                    </button>
                                    <button href="#" class="btn btn-simple btn-link btn-icon">
                                        <i class="fa fa-google-plus-square"></i>
                                    </button>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<!--   Core JS Files   -->
<script src="assets/js/core/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="assets/js/plugins/bootstrap-switch.js"></script>
<!--  Google Maps Plugin    -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
<!--  Chartist Plugin  -->
<script src="assets/js/plugins/chartist.min.js"></script>
<!--  Notifications Plugin    -->
<script src="assets/js/plugins/bootstrap-notify.js"></script>
<!-- Control Center for Light Bootstrap Dashboard: scripts for the example pages etc -->
<script src="assets/js/light-bootstrap-dashboard.js?v=2.0.0 " type="text/javascript"></script>


<script type="text/javascript">

function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

</script>




<script type="text/javascript">

		var userElement = document.getElementById('usrName').value;
		var emailElement = document.getElementById('usrEmail').value;
        var firstnameElement = document.getElementById('usrFirst').value;
        var lastnameElement = document.getElementById('usrLast').value;
        var passwordElement = document.getElementById('usrPass').value;
        var tokenElement = document.getElementById('usrToken').value;
        var bioElement = document.getElementById('usrBio').value;
        
     



        var full = "http://ec2-54-82-98-123.compute-1.amazonaws.com/GetUserInfoByUsername?username="+getCookie("username");



        //for hardware token
        var token = "http://ec2-54-82-98-123.compute-1.amazonaws.com/GetHWTokenByUsername?username="+getCookie("username");
        


        fetch(full)
		.then(function(response){
			if (response.ok){
				//window.alert("Registration successful. Check your email for your account's hardware token.");
                //var userinfo = response.json()

                response.json()
                .then(data => {

                userElement = data.Username;
                emailElement = data.Email;
                firstnameElement = data.FirstName;
                lastnameElement = data.LastName;
                passwordElement = data.Password;
                bioElement = data.UserBio;


                document.getElementById('usrName').value = userElement;
                document.getElementById('usrEmail').value = emailElement;

                document.getElementById('usrFirst').value = firstnameElement;
                document.getElementById('usrLast').value = lastnameElement;

                document.getElementById('usrPass').value = passwordElement;

                //document.getElementById('usrToken').value;
                document.getElementById('usrBio').value = bioElement;


                
                //border UI profile stuff
                document.getElementById('borderBio').innerHTML = bioElement;
                document.getElementById('borderUsername').innerHTML = userElement;
                document.getElementById('borderName').innerHTML = firstnameElement + " " + lastnameElement;


                }
                
                
                )
                
                //retrieved elements
                
			} 
			else
			{	
				window.alert("Couldn't retreive user information. Please try again.");
			}
		})
        
        


        fetch(token)
		.then(function(response){
			if (response.ok){
				//window.alert("Registration successful. Check your email for your account's hardware token.");
                //var userinfo = response.json()

                response.json()
                .then(data => {

                tokenElement = data.Hardwaretoken;
                document.getElementById('usrToken').value = tokenElement;
                
                }
                
                )
                
			} 
			else
			{	
				window.alert("Couldn't retreive hardware token. Please try again.");
			}
		})
	
</script>




<script type="text/javascript">
function updateInfo()
{

    var user = document.getElementById('usrName').value;
    var email = document.getElementById('usrEmail').value;

    var firstName = document.getElementById('usrFirst').value;
    var lastName = document.getElementById('usrLast').value;

    var pass = document.getElementById('usrPass').value;
    var bio = document.getElementById('usrBio').value;


    var full = "http://ec2-54-82-98-123.compute-1.amazonaws.com/UpdateUserInfo?username="+user+"&pass="+pass+"&email="+email+"&first_name="+firstName+"&last_name="+lastName+"&user_bio="+bio;
    
    //alert(full);

	
    fetch(full)
    .then(function(response){
        if (response.ok){
            window.alert("Your account information has been updated.");
            window.location.assign("/dashboard.html");
        } 
        else
        {	
            window.alert("We weren't able to update your account information. Please try again.");
        }
    })
                
}


</script>















</html>
